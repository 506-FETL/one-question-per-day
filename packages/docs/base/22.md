---
tags: [äºŒå‰æ ‘, åºåˆ—åŒ–, ååºåˆ—åŒ–]
difficulty: medium
---

# äºŒå‰æ ‘çš„åºåˆ—åŒ–ä¸ååºåˆ—åŒ–

## ğŸ“– é¢˜ç›®æè¿°

è®¾è®¡ä¸€ä¸ªç®—æ³•ï¼Œå®ç°äºŒå‰æ ‘çš„ **åºåˆ—åŒ–** ä¸ **ååºåˆ—åŒ–**ã€‚

- **åºåˆ—åŒ–**ï¼šå°†äºŒå‰æ ‘è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œä¾¿äºå­˜å‚¨æˆ–ä¼ è¾“ã€‚
- **ååºåˆ—åŒ–**ï¼šå°†å­—ç¬¦ä¸²è¿˜åŸæˆåŸæ¥çš„äºŒå‰æ ‘ç»“æ„ã€‚

å¿…é¡»ä¿è¯ååºåˆ—åŒ–åçš„äºŒå‰æ ‘ä¸åŸå§‹äºŒå‰æ ‘ç»“æ„å®Œå…¨ä¸€è‡´ã€‚

## ğŸ” ç¤ºä¾‹

ç»™å®šå¦‚ä¸‹äºŒå‰æ ‘ï¼š

```
        1
       / \
      2   3
     /     \
    4       5
   / \     /
  6   7   8
       \
        9
```

å¯èƒ½çš„åºåˆ—åŒ–ç»“æœä¸ºï¼š

```
"1,2,3,4,null,null,5,6,7,8,null,null,null,null,9"
```

## âœ… è¦æ±‚

1. å®ç° `serialize(root)`ï¼šå°†äºŒå‰æ ‘è½¬æ¢ä¸ºå­—ç¬¦ä¸²ã€‚
2. å®ç° `deserialize(str)`ï¼šå°†å­—ç¬¦ä¸²è¿˜åŸä¸ºäºŒå‰æ ‘ã€‚
3. éœ€ä¿è¯ï¼š`deserialize(serialize(root))` ç­‰ä»·äºåŸå§‹è¾“å…¥çš„äºŒå‰æ ‘ã€‚

## é¢˜ç›®æ¨¡ç‰ˆ

::: code-group

```js [serialize.js]
// This is the class for the node
// you can use this directly as it is bundled with your code

class Node {
  value
  left
  right
  constructor(val) {
    this.value = val
    this.left = null
    this.right = null
  }
}

/**
 * @param {Node} root
 * @return {string}
 */
export function serialize(root) {
}

/**
 * @param {string} str
 * @return {Node}
 */
export function deserialize(str) {
}

```

:::

## æµ‹è¯•ä»£ç 

::: code-group

```js [test.js]
import { describe, expect, it } from 'vitest'
import { deserialize, serialize } from './serialize'

// Helper to build plain tree nodes (since Node class not exported)
function node(value, left = null, right = null) {
  return { value, left, right }
}

describe('serialize / deserialize (Day 22)', () => {
  it('serialize(null) åº”è¿”å›ç©ºæ•°ç»„ [] (ç¬¦åˆå½“å‰å®ç°)', () => {
    expect(serialize(null)).toEqual([])
  })

  it('åºåˆ—åŒ–å•èŠ‚ç‚¹', () => {
    const tree = node('A')
    expect(serialize(tree)).toBe('A')
  })

  it('åºåˆ—åŒ–ä¸å¹³è¡¡äºŒå‰æ ‘å¹¶å»é™¤å°¾éƒ¨å¤šä½™ null', () => {
    //    A
    //   /
    //  B
    // /
    // C
    const tree = node('A', node('B', node('C'), null), null)
    const s = serialize(tree)
    expect(s).toBe('A,B,null,C')
    expect(s.endsWith('null')).toBe(false)
  })

  it('åºåˆ—åŒ–å®Œæ•´ä¸¤å±‚ (æ•°å­—å€¼)', () => {
    //    1
    //   / \
    //  2   3
    const tree = node(1, node(2), node(3))
    expect(serialize(tree)).toBe('1,2,3')
  })

  it('deserialize ç©ºå­—ç¬¦ä¸²è¿”å› null', () => {
    expect(deserialize('')).toBeNull()
  })

  it('deserialize çº¯å­—ç¬¦åºåˆ— (æ— é€—å·) èƒ½æ­£ç¡®æ„å»ºå®Œå…¨äºŒå‰æ ‘å‰ä¸‰ä¸ªèŠ‚ç‚¹', () => {
    const root = deserialize('ABC')
    expect(root.value).toBe('A')
    expect(root.left?.value).toBe('B')
    expect(root.right?.value).toBe('C')
    // ç”±äºé•¿åº¦è€—å°½ï¼Œä¸å†ç”Ÿæˆæ›´å¤šèŠ‚ç‚¹
    expect(root.left.left).toBeNull()
  })

  it('serialize ä¸ deserialize ä¸å…¼å®¹çš„ç¼ºé™·: round-trip å¤±è´¥ (æš´éœ²å½“å‰é€»è¾‘é—®é¢˜)', () => {
    const tree = node('A', node('B', node('C'), null), null)
    const s1 = serialize(tree) // 'A,B,null,C'
    const rebuilt = deserialize(s1) // é€å­—ç¬¦è§£æ
    const s2 = serialize(rebuilt)
    expect(s2).not.toBe(s1) // è¯æ˜å½“å‰å®ç°ä¸åŒ¹é…
  })

  it('deserialize(serialize(å•èŠ‚ç‚¹)) ç»“æœå¹¶éæœŸæœ›çš„åŒæ„æ ‘ (å› é€—å·å¤„ç†é—®é¢˜)', () => {
    const original = node('X')
    const s = serialize(original) // 'X'
    const rebuilt = deserialize(s)
    // è¿™é‡Œæ°å¥½è¿˜èƒ½åŒ¹é… (å•å­—ç¬¦æ— é€—å·)ï¼š
    expect(rebuilt.value).toBe('X')
    expect(rebuilt.left).toBeNull() // deserialize ä¸ä¼šä¸»åŠ¨è¡¥ null
    expect(rebuilt.right).toBeNull()
  })

  it('deserialize è§£æåŒ…å«é€—å·çš„åºåˆ—æ—¶ä¼šæŠŠé€—å·å½“ä½œèŠ‚ç‚¹å€¼ (éªŒè¯ç¼ºé™·)', () => {
    const s = 'A,B' // è¿™å¹¶ä¸æ˜¯ serialize è¾“å‡º (ç¼ºå°‘é€—å·åˆ†éš”é€»è¾‘æ”¯æŒ)
    const root = deserialize(s)
    // root: 'A', left: ',', right: 'B'
    expect(root.value).toBe('A')
    expect(root.left?.value).toBe(',')
    expect(root.right?.value).toBe('B')
  })
})

```

:::

## ç­”æ¡ˆ

| ç±»å‹    | è·¯å¾„                                                                                                                              |
| ------- | --------------------------------------------------------------------------------------------------------------------------------- |
| JS ç‰ˆæœ¬ | [problems/Day 22/answer.js](https://github.com/506-FETL/one-question-per-day/blob/main/packages/problems/base/Day%2022/answer.js) |
| TS ç‰ˆæœ¬ | å¾…è¡¥å……                                                                                                                            |
| Review  | å¾…è¡¥å……                                                                                                                            |
