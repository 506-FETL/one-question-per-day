# Button

## 一、目标

实现一个 **功能完善、可复用、可扩展** 的 `Button` 组件，具备以下特性：

- ✅ 支持多种 **外观 (variant)** 与 **尺寸 (size)**
- ✅ 支持 **加载状态 (loading)**
- ✅ 支持 **左/右图标 (leftIcon / rightIcon)**
- ✅ 支持 **全宽模式 (fullWidth)**
- ✅ 语义化、可访问性良好（`aria-*` 属性）
- ✅ 基于 TypeScript

## 二、核心 Props

- **variant**: `'default' | 'destructive' | 'outline' | 'secondary' | 'ghost' | 'link'`
  控制按钮外观风格。
- **size**: `'default' | 'sm' | 'lg' | 'icon'`
  控制按钮尺寸。
- **loading**: `boolean`
  是否进入加载状态。
- **loadingText**: `string`
  提供加载时的替换文本。
- **leftIcon / rightIcon**: `ReactNode`
  左/右图标。
- **fullWidth**: `boolean`
  是否撑满整行。
- **className**: `string`
  自定义样式扩展。
- **type**: `'button' | 'submit' | 'reset'`
  默认值是 `'button'`。
- 其他原生 `button` 属性通过 `{...rest}` 透传。

## 三、样式组织思路

- **baseClasses**: 所有按钮共用的基础样式（对齐、字体、禁用态、焦点态等）。
- **variantClasses**: 不同外观对应的类（如 primary、outline、link）。
- **sizeClasses**: 不同尺寸对应的类（如 sm、lg、icon）。
- **组合方式**:

  ```tsx
  className={cn([
    baseClasses,
    variantClasses[variant],
    sizeClasses[size],
    fullWidth ? 'w-full' : '',
    variant, // 方便调试/测试
    size,
    className, // 允许外部覆盖
  ])}
  ```

## 四、功能实现逻辑

1. **默认行为**
   - 默认 `type="button"`
   - 支持传入自定义 `className`
   - 透传事件（如 `onClick`）

2. **加载状态 (loading)**
   - 添加 `aria-busy="true"`
   - 禁用按钮 (`disabled`)
   - 隐藏右侧图标，避免干扰
   - 若传入 `loadingText`，替换掉原文本

3. **图标支持**
   - 左右图标用 `<span>` 包裹，控制间距
   - loading 时 **只隐藏右图标**，左图标可保留

4. **可访问性 (a11y)**
   - `aria-busy` 标记加载中
   - `disabled` 阻止交互
   - `size="icon"` 时需要 `aria-label`，否则无文本按钮不易被辅助工具识别

5. **样式扩展**
   - `variant` 与 `size` 同时作用于 className 和 `data-*` 属性
   - 测试时可通过 `className` 或 `data-attr` 判断

## 五、测试点

- **基础渲染**
  - 渲染子元素内容
  - 默认 `type="button"`
  - `className` 可继承

- **事件处理**
  - 点击触发 `onClick`
  - `disabled` 时不触发点击
  - 显式 `type` 可覆盖默认

- **外观与尺寸**
  - 切换 `variant` → 不同类名生效
  - 切换 `size` → 不同类名生效
  - `fullWidth` → 添加 `w-full`

- **加载状态**
  - `aria-busy="true"` & `disabled`
  - `loadingText` 替换原文本
  - 点击不会触发事件

- **图标**
  - 左右图标能渲染
  - loading 时隐藏右图标
  - `size="icon"` 时需 `aria-label`

## 六、关键知识点

1. **组合 className**：使用 `cn()` 函数高效拼接。
2. **React + TS 结合**：Props 类型设计合理，兼顾扩展性与约束。
3. **可访问性保证**：通过 `aria-*` 属性 & `aria-label`。
4. **健壮性测试**：覆盖功能点（交互 / 样式 / 状态 / 无障碍）。
5. **组件封装思想**：职责清晰 → UI 外观 (variant/size)、状态管理 (loading/disabled)、可扩展性 (className、icon)。

## 七、复习清单

- [ ] 掌握 `variant` / `size` 的实现方式与扩展思路
- [ ] 理解 `loading` 与 `loadingText` 的逻辑分支
- [ ] 理解如何通过 `aria-*` 与 `disabled` 提升可访问性
- [ ] 复盘图标渲染逻辑（loading 时隐藏右图标）
- [ ] 熟悉测试用例覆盖点，能根据需求写出断言
